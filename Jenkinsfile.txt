node {
    try {
        stage('Checkout') {
            bat "xcopy /E PATH_TO_YOURPROJECT /Y"
        }
        stage ('Package Stage') {
            bat './mvnw clean package'
        }
        
        stage('Sonar Scanner Coverage') {
            bat "./mvnw sonar:sonar -Dsonar.login=91c7ac935a0980111957527ad09ddc60d12aab87 -Dsonar.host.url=http://localhost:9000"
        }
        stage ('Publish to Nexus') {
            nexusPublisher nexusInstanceId: 'nexusserver', nexusRepositoryId: 'pipeline_snapshot_test1', packages: [[$class: 'MavenPackage', mavenAssetList: [[classifier: '', extension: '', filePath: './target/gift-shop-api.war']],mavenCoordinate: [artifactId: 'sonar-maven-plugin', groupId: 'org.sonarsource.scanner.maven', packaging: 'war', version: '3.8.5']]]
        }

       
    }
    catch (e) {
        def to = "spartaraja@gmai.com"
        currentBuild.result = 'FAILURE'
        def subject = "Jenkins - Build FAILURE"
        def content = '${JELLY_SCRIPT,template="html"}'
        emailext(body: content, mimeType: 'text/html',
                replyTo: '$DEFAULT_REPLYTO', subject: subject,
                to: to)
    }
}